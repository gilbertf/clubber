<!DOCTYPE html>
<html lang=de>
	<head>
		<title>{% block title %}{% endblock %}</title>
		{% load static %}

        <link rel="stylesheet" href="{% static 'bootstrap/css/bootstrap.min.css' %}">
		<link rel="stylesheet" href="{% static 'flatpickr/css/flatpickr.min.css' %}" media="all">
		<link rel="icon" href="{% static 'favicon.png' %}" type="image/png">

		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
	</head>

	<script src="{% static 'jquery.min.js' %}"></script>
	<script src="{% static 'bootstrap/js/bootstrap.bundle.min.js' %}"></script>
	<script src="{% static 'flatpickr/js/flatpickr.min.js' %}"></script>
	<script src="{% static 'flatpickr/js/django-flatpickr.js' %}"></script>
	<script src="{% static 'flatpickr/js/l10n/de.js' %}"></script>  
	<script src="{% static 'htmx.min.js' %}"></script>  

	<body hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>
		<div class="container text-center" w-100>
			{% if LOGO_ENABLE %}
				<a href="{{ LOGO_URL }}">
					<img class="img-fluid text-center" src="/static/logo.png">
				</a>
			{% endif %}

			{% load static %}

			<nav class="navbar sticky-top navbar-toggleable-md navbar-expand navbar-light bg-light">
			  	<div class="collapse navbar-collapse" id="navbarNavAltMarkup">
			    		<div class="navbar-nav">
						<a class="navbar-item nav-link{% if request.path == "/" %} active{% endif %}" href="/">Treffen</a>

						{% if not user.is_authenticated %}
							<a class="nav-item nav-link{% if request.path == "/login" %} active{% endif %}" href="{% url 'login' %}">Einloggen</a>
						{% endif %}

						{% if not user.is_authenticated %}
							<a class="nav-item nav-link{% if request.path == "/account/register" %} active{% endif %}" href="/account/register">Registrieren</a>
						{% endif %}

						{% if user.is_authenticated %}
							<li class="nav-item dropdown">
								  <a class="nav-link dropdown-toggle{% if request.path == "/account/change" or request.path == "/email" or request.path == "/users" %} active{% endif %}" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Einstellungen</a>
								<ul class="dropdown-menu">
									<a class="dropdown-item{% if request.path == "/account/change" %} active{% endif %}" href="/account/change">Passwort Ã¤ndern</a>
	
									<a class="dropdown-item{% if request.path == "/email" %} active{% endif %}" href="/email">E-Mail</a>

									<form id="form-logout" action="{% url 'logout' %}" method="post">
										{% csrf_token %}
									    <input type="hidden"></input>
									</form>
									<script>
										$(document).ready(function(){
											$("#logout").click(function(e){
												$("#form-logout").submit();
											});
										});
									</script>
									<a class="dropdown-item" id="logout">Ausloggen</a>

									{% if user.is_superuser %}
		            							<li><hr class="dropdown-divider"></li>
										<a class="dropdown-item{% if request.path == "/users" %} active{% endif %}" href="/users">Benutzerverwaltung</a>
										<a class="dropdown-item{% if request.path == "/typ/list" %} active{% endif %}" href="/typ/list">Veranstaltungsarten</a>
									{% endif %}
								 </ul>
							</li>
						{% endif %}

						{% if user.is_staff %}
							<a class="nav-item nav-link{% if request.path == "/add" %} active{% endif %}" href="/add">Neues Treffen</a>
						{% endif %}
			    		</div>
			  	</div>
			</nav>
		</div>

		<div class="container py-3">
			{% block content %}
			{% endblock %}
		</div>

		<footer class="py-3 my-4">
		      <ul class="nav justify-content-center border-top pb-3 mb-3">
				<li class="nav-item"><a href="/impressum" class="nav-link px-2 {% if request.path == "/impressum" %}text-dark{% else %}text-body-secondary{% endif %}">Impressum</a></li>
				<li class="nav-item"><a href="https://github.com/gilbertf/clubber" class="nav-link px-2 text-body-secondary">Clubber.</a></li>
		      </ul>
		</footer>
	</body>
</html>
